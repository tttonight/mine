<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>验证用户是否输入</title>
    <link rel="stylesheet" type="text/css" href="../bootstrap/dist/css/bootstrap.min.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="../bootstrap/dist/css/bootstrap-theme.min.css" media="all"/>
    <style>
    .demo1 {width:500px; margin:0 auto; padding-top:100px;}
    .input{ padding:5px 6px; margin-right:10px;text-align:center;}
    .popover {position:absolute;left:450px;width:100px;display:block;}
    .popover-content {padding:4px 10px; color:#f00;}
    </style>
</head>
<body>
<div class="demo1">
    <form class="form-horizontal user-input" id="form" role="form">
        <div class="form-group">
            <label for="user" class="col-sm-2 control-label">用户名</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="user" placeholder="用户名">
                <div class="popover right">
                <div class="popover-content">
                    <div class="">不能为空</div>
                </div>
                <div class="arrow"></div>
            </div>
            </div>
        </div>

        <div class="form-group">
            <label for="password" class="col-sm-2 control-label">密码</label>
            <div class="col-sm-10">
                <input type="password" class="form-control" id="password" placeholder="密码">

            </div>
        </div>
        <div class="form-group">
            <label for="msg" class="col-sm-2 control-label">备注</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="msg" placeholder="备注" row="3"></textarea>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <div class="checkbox">
                    <label>
                        <input type="checkbox">  记住我 <!--这里不能加value=""，否则下面的input.value.length==0，不加即==2-->
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button id="btn" type="button" class="btn btn-primary btn-block">提 交</button>
            </div>
        </div>
    </form>
</div>
<script>
    /**
    * 思路分析：
    *   1、先想功能（判断输入框是否为空、显示或者隐藏提示框，新建提示框）
    *   2、每个功能可以写为一个函数，有些有关联，或者有些需要多步的可以封装为一个函数
    */
    /**
    * 注意的点：
    *   1、传入参数时，要注意参数是否为必须的参数，如果不是，要考虑如果没有传入参数要怎么处理，参考（div函数中的txt && (d.innerHTML = txt)）
    */
    (function(){
        var form = document.getElementById('form');
        var input = form.getElementsByTagName('input');
        var textarea = form.getElementsByTagName('textarea');
        var btn = document.getElementById('btn');
        var reg = /\D/gi;
        btn.onclick = function(){
            checkNull();
            return false;
        }
        /**
        * 初始化
        */
        function init(){
            for(var i = 0; i < input.length; i++){
                input[i].onfocus = function(){
                    error(this, '', 1);
                }
            }
        }
        init();
        function checkNull(){
            for(var i = 0; i < input.length; i++){
                if(input[i].value.length < 1){
                    //console.log(i);
                    error(input[i], '不能为空');
                    input[i].className.indexOf('error') == -1 && (input[i].className += ' error');
                }
            }
        }
        /**
        * 显示或者隐藏提示框
        */
        function error(o, txt, show){
            //if在init中，判断当鼠标点入输入框时，隐藏提示框
            if(arguments.length == 3 && show){
                //o.tip???
                o.tip && (o.tip.style.display = 'none');
            } else {
                //当o的class里没有 error时，创建提示框
                if(o.className.search(/error/) == -1){
                    o.tip = over(o, txt);
                } else {
                    o.tip.style.display = 'block';
                }

            }
        }
        /**
        * 新建一个提示框的div，返回该提示框
        */
        /**
        结果：
        <div class="col-sm-10">
            <input id="user" class="form-control error" placeholder="用户名" type="text">
            <div class="popover right">
                <div class="popover-content">
                    <div class="">不能为空</div>
                </div>
                <div class="arrow"></div>
            </div>
        </div>
        */
        function over(o, txt){
            var pop = div('popover right');
            var arr = div('arrow');
            var content = div('popover-content');
            content.appendChild(div('', 'p', txt));
            pop.appendChild(content);
            pop.appendChild(arr);
            //在o.prentNode里面插入pop节点，将pop节点插入到o.nextSibling之前
            o.parentNode.insertBefore(pop, o.nextSibling);
            return pop;
        }
        /**
        * 创建新的Element--div
        * @cls classname
        * @tag ？
        * @txt div里面填充的值
        */
        function div(cls, tag, txt){
            if(!tag){
                tag = cls;
            }
            var d = document.createElement('div' || tag);
            d.className = cls;
            //这里应该注意txt是否有传入参数,如果没有txt为false，即不会赋值
            txt && (d.innerHTML = txt);
            return d;
        }
        //用户名输入框只能输入数字
        input[0].onkeyup = function() {
            input[0].value=input[0].value.replace(reg, '');
        }
    }());
</script>
</body>
</html>
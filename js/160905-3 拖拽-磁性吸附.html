<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
 <meta charset="utf-8">
  <title> 拖拽 </title>
  <!--注意：父级必须有相对定位，子级才能有相对定位-->
  <style>
  #div1 {width:100px;height:100px;background:red;position:absolute;}
  #div2 {width:700px;height:400px;background:yellow;position:relative;}
  </style>
  <script>
  window.onload=function() {
	  var oDiv = document.getElementById("div1");
	  var oDiv2 = document.getElementById("div2")
	  //disX表示鼠标距离窗口的距离
	  var disX=0;
	  var disY=0;
	  //鼠标按下
	  oDiv.onmousedown = function(ev) {
		  var oEvent=ev||event;
		  
		  disX=oEvent.clientX-oDiv.offsetLeft;
		  disY=oEvent.clientY-oDiv.offsetTop;
		  //window.alert(disX+","+disY)
		  //鼠标移动
		  //注意：鼠标如果移动太快，div脱离了鼠标，导致div不动了，使用document
		  document.onmousemove=function(ev) {
			  var oEvent=ev||event;
			  
			  l=oEvent.clientX-disX;
			  t=oEvent.clientY-disY;
			  
			  //控制div不跑出可视区范围
			  if(l<50) {
				  l=0;
			  }else if(l>oDiv2.offsetWidth-oDiv.offsetWidth-50){
				  l=oDiv2.offsetWidth-oDiv.offsetWidth;	  
			  }
			  
			  if(t<50) {
				  t=0;
			  }else if(t>oDiv2.offsetHeight-oDiv.offsetHeight-50) {
				  t=oDiv2.offsetHeight-oDiv.offsetHeight;
			  }
			  oDiv.style.left=l+"px";
			  oDiv.style.top=t+"px";
			}
		  //鼠标移开
		  oDiv.onmouseup=function() {
			  //只需要将移动置为0即可
			  document.onmousemove=null;
			  document.onmousedown=null;
		  }
		return false;
	  }
	  
  }
  </script>
 </head>
 <body>
 <div id="div2">
 <div id="div1"></div>
 </div>
 </body>

</html>
